<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 30px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
        }

        .info {
            background: #f0f4ff;
            padding: 35px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }

        .prices-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .price-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #e0e0e0;
        }

        .price-card h3 {
            margin-bottom: 15px;
            color: #667eea;
            font-size: 18px;
        }

        .price-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .price-item:last-child {
            border-bottom: none;
        }

        .price-input {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .price-input input {
            width: 100px;
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .update-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .update-btn:hover {
            background: #45a049;
        }

        .update-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .notification-success {
            background: #4CAF50;
        }

        .notification-error {
            background: #f44336;
        }

        .back-btn {
            display: inline-block;
            margin-top: 20px;
            padding: 10px 20px;
            background: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
        }

        .back-btn:hover {
            background: #5568d3;
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1>üë®‚Äçüíº –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω</h1>
            <p>–†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ü–µ–Ω—ã –¥–ª—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –ü–ö –∏ –Ω–æ—É—Ç–±—É–∫–æ–≤</p>
            <a href="/" class="back-btn">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>
        </header>

        <div class="info">
            <strong>‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</strong>
            <ul>
                <li>–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ —Ñ–∞–π–ª <code>prices.json</code></li>
                <li>–¶–µ–Ω—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</li>
                <li>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: <span id="lastUpdated">-</span></li>
            </ul>
        </div>

        <div id="pricesContainer" class="prices-grid">
            <!-- –¶–µ–Ω—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </div>
    </div>

    <script>
        const API_URL = 'http://localhost:3000/api';
        let prices = {};

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ü–µ–Ω
        async function loadPrices() {
            try {
                const response = await fetch(`${API_URL}/all-prices`);
                const data = await response.json();

                prices = data.prices;
                document.getElementById('lastUpdated').textContent =
                    new Date(data.timestamp).toLocaleString('ru-RU');

                renderPrices();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ü–µ–Ω:', error);
                showNotification('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ü–µ–Ω—ã', 'error');
            }
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ü–µ–Ω
        function renderPrices() {
            const container = document.getElementById('pricesContainer');
            container.innerHTML = '';

            Object.entries(prices).forEach(([category, items]) => {
                if (category === 'metadata') return;

                const card = document.createElement('div');
                card.className = 'price-card';
                card.innerHTML = `<h3>${getCategoryName(category)}</h3>`;

                Object.entries(items).forEach(([id, price]) => {
                    const item = document.createElement('div');
                    item.className = 'price-item';
                    item.innerHTML = `
                        <span>${getComponentName(id)}</span>
                        <div class="price-input">
                            <span>‚ÇΩ</span>
                            <input type="number" 
                                   data-category="${category}" 
                                   data-id="${id}" 
                                   value="${price}" 
                                   min="0">
                            <button class="update-btn" 
                                    onclick="updatePrice('${category}', '${id}', this)">üíæ</button>
                        </div>
                    `;
                    card.appendChild(item);
                });

                container.appendChild(card);
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã
        async function updatePrice(category, id, button) {
            const input = button.previousElementSibling;
            const newPrice = parseInt(input.value);

            if (isNaN(newPrice) || newPrice < 0) {
                showNotification('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ü–µ–Ω–∞', 'error');
                return;
            }

            button.disabled = true;
            button.textContent = '‚è≥';

            try {
                const response = await fetch(`${API_URL}/update-prices`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ category, productId: id, price: newPrice })
                });

                const data = await response.json();

                if (data.success) {
                    showNotification(`‚úÖ ${data.message}`, 'success');
                    button.textContent = '‚úÖ';
                    setTimeout(() => {
                        button.disabled = false;
                        button.textContent = 'üíæ';
                    }, 1000);
                } else {
                    throw new Error(data.error || '–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞:', error);
                showNotification(`‚ùå ${error.message}`, 'error');
                button.disabled = false;
                button.textContent = 'üíæ';
            }
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function getCategoryName(category) {
            const names = {
                'cpu': '–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã',
                'gpu': '–í–∏–¥–µ–æ–∫–∞—Ä—Ç—ã',
                'mb': '–ú–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏–µ –ø–ª–∞—Ç—ã',
                'case': '–ö–æ—Ä–ø—É—Å–∞',
                'ram': '–û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å (–∑–∞ 1 –ì–ë)',
                'storage': '–ù–∞–∫–æ–ø–∏—Ç–µ–ª–∏ (–∑–∞ 1 –ì–ë)',
                'psu': '–ë–ª–æ–∫–∏ –ø–∏—Ç–∞–Ω–∏—è (–∑–∞ 100 –í—Ç)',
                'laptopCpu': '–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –Ω–æ—É—Ç–±—É–∫–æ–≤',
                'laptopGpu': '–í–∏–¥–µ–æ–∫–∞—Ä—Ç—ã –Ω–æ—É—Ç–±—É–∫–æ–≤',
                'laptopBrand': '–ë—Ä–µ–Ω–¥—ã –Ω–æ—É—Ç–±—É–∫–æ–≤',
                'laptopRam': '–û–ó–£ –Ω–æ—É—Ç–±—É–∫–æ–≤ (–∑–∞ 1 –ì–ë)',
                'laptopStorage': '–ù–∞–∫–æ–ø–∏—Ç–µ–ª–∏ –Ω–æ—É—Ç–±—É–∫–æ–≤ (–∑–∞ 1 –ì–ë)',
                'laptopDisplay': '–≠–∫—Ä–∞–Ω—ã –Ω–æ—É—Ç–±—É–∫–æ–≤'
            };
            return names[category] || category;
        }

        function getComponentName(id) {
            const names = {
                'i3-13100': 'Intel Core i3-13100',
                'i5-13400': 'Intel Core i5-13400',
                'i5-13600k': 'Intel Core i5-13600K',
                'i7-13700k': 'Intel Core i7-13700K',
                'ryzen5-7600': 'AMD Ryzen 5 7600',
                'ryzen7-7800x3d': 'AMD Ryzen 7 7800X3D',
                'rtx3060': 'NVIDIA RTX 3060 12GB',
                'rtx4060': 'NVIDIA RTX 4060 8GB',
                'rtx4070': 'NVIDIA RTX 4070 12GB',
                'rx7600': 'AMD RX 7600 8GB',
                'rx7800xt': 'AMD RX 7800 XT 16GB',
                'b660': 'B660 (Intel)',
                'b760': 'B760 (Intel)',
                'b650': 'B650 (AMD)',
                'x670': 'X670 (AMD)',
                'budget': '–ë—é–¥–∂–µ—Ç–Ω—ã–π',
                'mid': '–°—Ä–µ–¥–Ω–∏–π –∫–ª–∞—Å—Å',
                'premium': '–ü—Ä–µ–º–∏—É–º',
                'i5-1335u': 'Intel Core i5-1335U',
                'i7-1360p': 'Intel Core i7-1360P',
                'ryzen5-7530u': 'AMD Ryzen 5 7530U',
                'ryzen7-7730u': 'AMD Ryzen 7 7730U',
                'integrated': '–í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è',
                'mx550': 'NVIDIA MX550',
                'rtx3050': 'NVIDIA RTX 3050',
                'rtx4060': 'NVIDIA RTX 4060',
                'asus': 'ASUS',
                'lenovo': 'Lenovo',
                'hp': 'HP',
                'dell': 'Dell',
                'acer': 'Acer',
                'msi': 'MSI',
                'perGB': '–ó–∞ 1 –ì–ë',
                'per100W': '–ó–∞ 100 –í—Ç',
                '14': '14 –¥—é–π–º–æ–≤',
                '15.6': '15.6 –¥—é–π–º–æ–≤',
                '16': '16 –¥—é–π–º–æ–≤',
                '17.3': '17.3 –¥—é–π–º–æ–≤'
            };
            return names[id] || id;
        }

        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease forwards';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        loadPrices();
    </script>
</body>

</html>